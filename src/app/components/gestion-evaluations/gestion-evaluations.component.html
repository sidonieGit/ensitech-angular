<section class="d-flex">
  <app-sidebar></app-sidebar>
  <main class="flex-grow-1">
    <app-topbar></app-topbar>
    <div class="container mt-4">
      <h2>Gestion des Évaluations</h2>
      <form (ngSubmit)="addEvaluation()" class="mb-4">
        <div class="row">
          <div class="col-md-3 mb-3">
            <label for="titre" class="form-label">Titre</label>
            <input type="text" id="titre" class="form-control" [(ngModel)]="newEvaluation.titre" name="titre" required>
          </div>
          <div class="col-md-3 mb-3">
            <label for="description" class="form-label">Description</label>
            <input type="text" id="description" class="form-control" [(ngModel)]="newEvaluation.description" name="description">
          </div>
          <div class="col-md-2 mb-3">
            <label for="date" class="form-label">Date</label>
            <input type="date" id="date" class="form-control" [(ngModel)]="newEvaluation.date" name="date" required>
          </div>
          <div class="col-md-2 mb-3">
            <label for="studentId" class="form-label">Étudiant</label>
            <select class="form-select" [(ngModel)]="newEvaluation.studentId" name="studentId" required>
              <option [value]="0" disabled>Choisir...</option>
              <option *ngFor="let s of students" [value]="s.id">{{ s.prenom }} {{ s.nom }}</option>
            </select>
          </div>
          <div class="col-md-1 mb-3">
            <label for="note" class="form-label">Note</label>
            <input type="number" id="note" class="form-control" [(ngModel)]="newEvaluation.note" name="note" min="0" max="20" required>
          </div>
          <div class="col-md-1 mb-3">
            <label for="coursId" class="form-label">Cours</label>
            <select class="form-select" [(ngModel)]="newEvaluation.coursId" name="coursId">
              <option [value]="undefined" disabled>...</option>
              <option *ngFor="let c of courses" [value]="c.id">{{ c.title }}</option>
            </select>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Ajouter</button>
      </form>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Titre</th>
            <th>Date</th>
            <th>Étudiant</th>
            <th>Note</th>
            <th>Cours</th>
            <th>Description</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let eval of evaluations">
            <td>{{ eval.titre }}</td>
            <td>{{ eval.date | date: 'dd/MM/yyyy' }}</td>
            <td>{{ getStudentName(eval.studentId) }}</td>
            <td>{{ eval.note }}</td>
            <td>{{ getCourseTitle(eval.coursId) }}</td>
            <td>{{ eval.description }}</td>
            <td>
              <button class="btn btn-danger btn-sm" (click)="deleteEvaluation(eval.id)">Supprimer</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </main>
</section>
